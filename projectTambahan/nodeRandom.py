import paho.mqtt.client as paho
import sys, datetime, time, json
from random import randint

# def sensorAsap():
# 	sensor = randint(30,800)
# 	return sensor

# def sensorSulfur():
# 	sensor = randint(50,3000)
# 	return sensor

# def sensorKarbon():
# 	sensor = randint(1,70)
# 	return sensor

# def sensorOzon():
# 	sensor = randint(100,2000)
# 	return sensor

# def sensorNitrogen():
# 	sensor = randint(200,4000)
# 	return sensor

client = paho.Client()
client.username_pw_set("admintes", "admin123")
client.connect("ngehubx.online", 1883)

# client.loop_start()
# while True :
	#=== MESSAGE TO PUBLISH ===
kirim = [{'id': 1, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 2, 'g1': 1 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 1, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 3, 'g1': 1 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 1, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 4, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 1, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 5, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 1, 'g29': 0}, {'id': 6, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 1, 'g22': 1, 'g23': 1, 'g24': 1, 
'g25': 1, 'g26': 1, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 7, 'g1': 0 , 'g2' : 0, 'g3': 1, 'g4': 1, 'g5': 1, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 8, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 1, 'g9': 0, 'g10': 1, 'g11': 0, 
'g12': 1, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 1, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 1, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 9, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 1, 'g6': 1, 'g7': 1, 'g8': 1, 'g9': 1, 'g10': 1, 'g11': 1, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 1, 'g16': 1, 'g17': 0, 'g18': 1, 'g19': 1, 'g20': 1, 'g21': 1, 'g22': 1, 'g23': 1, 'g24': 1, 
'g25': 1, 'g26': 1, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 10, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 1, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 1, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 0, 'g21': 1, 'g22': 0, 'g23': 0, 'g24': 1, 
'g25': 0, 'g26': 1, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 11, 'g1': 1 , 'g2' : 1, 'g3': 1, 'g4': 0, 'g5': 1, 'g6': 0, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 1, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 1, 'g26': 0, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 12, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 1, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 1, 'g26': 0, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 13, 'g1': 1 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 1, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 1, 
'g25': 0, 'g26': 1, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 14, 'g1': 1 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 1, 'g9': 1, 'g10': 1, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 1, 'g18': 1, 'g19': 1, 'g20': 0, 'g21': 1, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 1, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 15, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 16, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 1, 'g29': 0}, {'id': 17, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 1, 'g28': 0, 'g29': 1}, {'id': 18, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 1, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 19, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 1, 'g22': 1, 'g23': 1, 'g24': 1, 
'g25': 1, 'g26': 1, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 20, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 1, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 21, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 22, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 1, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 23, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 1, 'g9': 0, 'g10': 1, 'g11': 0, 
'g12': 1, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 1, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 1, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 24, 'g1': 1 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 1, 'g9': 1, 'g10': 1, 'g11': 1, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 1, 'g17': 0, 'g18': 1, 'g19': 0, 'g20': 0, 'g21': 1, 'g22': 1, 'g23': 1, 'g24': 1, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 25, 'g1': 1 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 1, 'g7': 0, 'g8': 1, 'g9': 1, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 1, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 1, 'g26': 0, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 26, 'g1': 1 , 'g2' : 0, 'g3': 1, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 1, 'g9': 0, 'g10': 1, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 1, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 1, 'g26': 1, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 27, 'g1': 1 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 1, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 1, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 1, 'g24': 1, 
'g25': 0, 'g26': 1, 'g27': 1, 'g28': 0, 'g29': 0}, {'id': 28, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 1, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 1, 'g14': 0, 'g15': 0, 'g16': 1, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 29, 'g1': 0 , 'g2' : 0, 'g3': 0, 'g4': 1, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 0, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}, {'id': 30, 'g1': 0 , 'g2' : 1, 'g3': 0, 'g4': 0, 'g5': 0, 'g6': 0, 'g7': 0, 'g8': 0, 'g9': 0, 'g10': 0, 'g11': 0, 
'g12': 0, 'g13': 0, 'g14': 0, 'g15': 1, 'g16': 0, 'g17': 0, 'g18': 0, 'g19': 0, 'g20': 0, 'g21': 0, 'g22': 0, 'g23': 0, 'g24': 0, 
'g25': 0, 'g26': 0, 'g27': 0, 'g28': 0, 'g29': 0}] #30 Pasien Total
# kirim = {'id': counter, 'asap': 20, 'nitrogen' : 15, 'sulfur': 10, 'karbon': 21, 'ozon': 14, 'timestamp': str(waktu)}
counter = 0
for i in kirim :
	pesan = json.dumps(kirim[counter])
	counter = counter + 1
	print pesan
	client.publish("project/dataPenyakit", pesan)
	time.sleep(1)

	# pesan = json.dumps(kirim)
	# message = pesan
	# print message
	# time.sleep(3)